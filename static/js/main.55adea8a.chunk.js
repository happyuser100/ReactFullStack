(this["webpackJsonpclient-app"]=this["webpackJsonpclient-app"]||[]).push([[0],{47:function(e,t,a){},61:function(e,t,a){},63:function(e,t,a){},65:function(e,t,a){"use strict";a.r(t);var n=a(3),s=a(1),c=a.n(s),r=a(19),o=a.n(r),i=(a(47),a(48),a(49),a(9)),l=a(14),h=a(16),d=a(15),u=a(21),j=function e(){var t=this;Object(i.a)(this,e),this._apiBase="http://localhost:9000/testAPI/",this.getResource=function(e){return fetch("".concat(t._apiBase).concat(e)).json()},this.getFleets=function(){return t.getResource("fleets/").fleets},this.getVessels=function(){return t.getResource("vessels/").vessels},this.getVesselLocations=function(){return t.getResource("vesselLocations/").vessels}},f=a(18),m=a(10),p=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s)))._apiBase="http://localhost:9000/testAPI/",e.fleetVesselService=new j,e.state={fleets:[],loading:!0,error:!1,sort:[{field:"name",dir:"asc"},{field:"cnt",dir:"asc"}]},e.getAllFleets=function(){fetch("".concat(e._apiBase).concat("fleets")).then((function(e){return e.json()})).then(e.onFleetsLoaded).catch(e.onError).finally((function(){e.setState({loading:!1})}))},e.onFleetsLoaded=function(t){e.setState({fleets:t,loading:!1,error:!1})},e.onError=function(t){e.setState({error:!0,loading:!1})},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.setState({loading:!0}),this.getAllFleets()}},{key:"render",value:function(){var e=this,t=this.state,a=t.fleets,s=t.loading,r=t.error;return s?Object(n.jsx)("p",{children:"Loading ..."}):!(s||r)?Object(n.jsx)(c.a.Fragment,{children:Object(n.jsx)("div",{className:"container",children:Object(n.jsx)("div",{className:"row",children:Object(n.jsxs)("div",{className:"col-md-12",children:[Object(n.jsx)("h1",{children:"Fleets Page"}),Object(n.jsxs)(f.a,{style:{height:"500px"},data:Object(m.c)(a,this.state.sort),sortable:!0,sort:this.state.sort,onSortChange:function(t){e.setState({sort:t.sort})},children:[Object(n.jsx)(f.b,{field:"name",title:"Name",width:"250px",cell:function(e){return Object(n.jsx)("td",{children:Object(n.jsx)(u.b,{to:"/vessels/".concat(e.dataItem._id),children:e.dataItem[e.field]})})}}),Object(n.jsx)(f.b,{field:"cnt",title:"Vessels Number",width:"200px",cell:function(e){return Object(n.jsx)("td",{children:Object(n.jsx)(u.b,{to:"/vessels/".concat(e.dataItem._id),children:e.dataItem[e.field]})})}})]})]})})})}):null}}]),a}(s.Component),b=(a(61),a(62),function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return Object(n.jsx)(c.a.Fragment,{children:Object(n.jsx)("div",{className:"vessels-app",children:Object(n.jsx)("div",{className:"container",children:Object(n.jsx)("div",{className:"row",children:Object(n.jsx)("div",{className:"col-md-12",children:Object(n.jsx)(p,{})})})})})})}}]),a}(s.Component)),g=a(7),v=a(32),O=(a(63),function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).state={termName:"",termMMSI:"",termFlag:""},e.onSearchChangeName=function(t){var a=t.target.value;e.setState({termName:a}),e.props.onSearchChangeName(a)},e.onSearchChangeMMSI=function(t){var a=t.target.value;e.setState({termMMSI:a}),e.props.onSearchChangeMMSI(a)},e.onSearchChangeFlag=function(t){var a=t.target.value;e.setState({termFlag:a}),e.props.onSearchChangeFlag(a)},e.search=function(t){t.preventDefault();var a=e.refName.current.value.trim();e.props.onSearchChangeName(a);var n=e.refMMSI.current.value.trim();e.props.onSearchChangeMMSI(n);var s=e.refFlag.current.value.trim();e.props.onSearchChangeFlag(s)},e.refName=c.a.createRef(),e.refMMSI=c.a.createRef(),e.refFlag=c.a.createRef(),e}return Object(l.a)(a,[{key:"render",value:function(){return Object(n.jsxs)("div",{className:"row",children:[Object(n.jsxs)("div",{className:"col-3",children:[Object(n.jsx)("label",{htmlFor:"name",children:"Search By Name: "}),Object(n.jsx)("input",{ref:this.refName,id:"name",className:"form-control search-input",placeholder:"Type to search name",value:this.state.termName,onChange:this.onSearchChangeName})]}),Object(n.jsxs)("div",{className:"col-3",children:[Object(n.jsx)("label",{htmlFor:"MMSI",children:"Search By MMSI: "}),Object(n.jsx)("input",{ref:this.refMMSI,id:"MMSI",className:"form-control search-input",placeholder:"Type to search MMSI",value:this.state.termMMSI,onChange:this.onSearchChangeMMSI})]}),Object(n.jsxs)("div",{className:"col-3",children:[Object(n.jsx)("label",{htmlFor:"Flag",children:"Search By Flag: "}),Object(n.jsx)("input",{ref:this.refFlag,id:"Flag",className:"form-control search-input",placeholder:"type to search flag",value:this.state.termFlag,onChange:this.onSearchChangeFlag})]}),Object(n.jsx)("div",{className:"col-3",children:Object(n.jsx)("button",{id:"btnSeacrh",type:"button",onClick:this.search,className:"btn btn-primary",children:"Search"})})]})}}]),a}(s.Component)),x=a(23),S=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.onClick;return t.map((function(e,t){return Object(n.jsx)(x.a,{longitude:e.longitude,latitude:e.latitude,children:Object(n.jsx)("svg",{height:20,viewBox:"0 0 24 24",style:{cursor:"pointer",fill:"#d00",stroke:"none",transform:"translate(".concat(-10,"px,").concat(-20,"px)")},onClick:function(){return a(e)},children:Object(n.jsx)("path",{d:"M20.2,15.7L20.2,15.7c1.1-1.6,1.8-3.6,1.8-5.7c0-5.6-4.5-10-10-10S2,4.5,2,10c0,2,0.6,3.9,1.6,5.4c0,0.1,0.1,0.2,0.2,0.3\n  c0,0,0.1,0.1,0.1,0.2c0.2,0.3,0.4,0.6,0.7,0.9c2.6,3.1,7.4,7.6,7.4,7.6s4.8-4.5,7.4-7.5c0.2-0.3,0.5-0.6,0.7-0.9\n  C20.1,15.8,20.2,15.8,20.2,15.7z"})})},"marker-".concat(t))}))}}]),a}(s.PureComponent),M=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.info,t="".concat(e.name,"}"),a="".concat(e.flag,"}"),c="".concat(e.mmsi,"}");return Object(n.jsxs)(s.Fragment,{children:[Object(n.jsx)("div",{className:"row",children:Object(n.jsxs)("div",{className:"col-md-12",children:["Name:",t," | "]})}),Object(n.jsx)("div",{className:"row",children:Object(n.jsxs)("div",{className:"col-md-12",children:["Flag:",a," | "]})}),Object(n.jsx)("div",{className:"row",children:Object(n.jsxs)("div",{className:"col-md-12",children:["MMSI:",c]})})]})}}]),a}(s.PureComponent),N=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s)))._apiBase="http://localhost:9000/testAPI/",e.fleetVesselService=new j,e.state={viewport:{latitude:37.8,longitude:-122.4,zoom:14,bearing:0,pitch:0},popupInfo:null},e.state={sort:[{field:"id",dir:"asc"},{field:"name",dir:"asc"},{field:"mmsi",dir:"asc"},{field:"flag",dir:"asc"}],fleet:{},fleets:[],vessels:[],vesselLocations:[],vesselLocationsMap:[],loading:!0,error:!1,searchName:"",searchMMSI:"",searchFlag:""},e._onClickMarker=function(t){e.setState({popupInfo:t})},e.onSearchChangeName=function(t){e.setState({searchName:t})},e.onSearchChangeMMSI=function(t){e.setState({searchMMSI:t})},e.onSearchChangeFlag=function(t){e.setState({searchFlag:t})},e.getAllFleets=function(){fetch("".concat(e._apiBase).concat("fleets")).then((function(e){return e.json()})).then(e.onFleetsLoaded).catch(e.onError)},e.onFleetsLoaded=function(t){e.setState({fleets:t,loading:!0,error:!1});var a=e.props.match.params.id,n=t.find((function(e){return e._id===a}));e.setState({fleet:n,loading:!0,error:!1}),e.getAllVessels()},e.getFleetsById=function(t){fetch("".concat(e._apiBase).concat("fleet","/").concat(t)).then((function(e){return e.json()})).then(e.onFleetsByIdLoaded).catch(e.onError)},e.onFleetsByIdLoaded=function(t){e.setState({fleet:t.Fleet,loading:!0,error:!1})},e.getAllVessels=function(){fetch("".concat(e._apiBase).concat("Vessels")).then((function(e){return e.json()})).then(e.onVesselsLoaded).catch(e.onError)},e.onVesselsLoaded=function(t){e.setState({vessels:t,loading:!0,error:!1}),e.getAllVesselLocations()},e.onError=function(t){e.setState({error:!0,loading:!0})},e.getAllVesselLocations=function(){fetch("".concat(e._apiBase).concat("vesselLocations")).then((function(e){return e.json()})).then(e.onVesselLocationsLoaded).catch(e.onError)},e.onVesselLocationsLoaded=function(t){var a=e.state.fleet.vessels,n=t.VesselLocations.map((function(e){var t=e._id,n=a.filter((function(e){return e._id===t}));return n&&n.length>0?e:null}));e.setState({vesselLocations:e.removeNull(n),loading:!0,error:!1}),e.getVesselLocationsMap()},e.getVesselLocationsMap=function(){var t=e.state.vesselLocations.map((function(t){var a=t._id,n=t.lastpos,s=n.geometry.coordinates[0],c=n.geometry.coordinates[1],r="",o="",i=";",l=e.state.vessels.Vessels.find((function(e){return e._id===a}));return l&&(r=l.name,o=l.flag,i=l.mmsi),{id:a,latitude:c,longitude:s,name:r,flag:o,mmsi:i}}));e.setState({vesselLocationsMap:t,loading:!1,error:!1})},e}return Object(l.a)(a,[{key:"_renderPopup",value:function(){var e=this,t=this.state.popupInfo;return t&&Object(n.jsx)(x.b,{tipSize:5,anchor:"top",longitude:t.longitude,latitude:t.latitude,closeOnClick:!1,onClose:function(){return e.setState({popupInfo:null})},children:Object(n.jsx)(M,{info:t})})}},{key:"componentDidMount",value:function(){this.setState({loading:!0}),this.getAllFleets()}},{key:"removeNull",value:function(e){return e.filter((function(e){return null!==e}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.searchName,s=t.searchMMSI,r=t.searchFlag,o=this.state,i=o.fleet,l=o.vessels,h=o.loading,d=(o.error,o.vesselLocationsMap);if(h)return Object(n.jsx)("p",{children:"Loading ..."});var j=this.state.fleet.vessels.map((function(e){var t=l.Vessels.filter((function(t){return t._id===e._id})),n=!!(t&&t[0]&&t[0].name)&&t[0].name.toLowerCase().includes(a.toLowerCase()),c=!!(t&&t[0]&&t[0].mmsi)&&t[0].mmsi.toString().toLowerCase().includes(s.toLowerCase()),o=!!(t&&t[0]&&t[0].flag)&&t[0].flag.toLowerCase().includes(r.toLowerCase());return n&&c&&o?{id:t[0]._id,name:t[0].name,mmsi:t[0].mmsi,flag:t[0].flag}:null}));return j=this.removeNull(j),Object(n.jsx)(c.a.Fragment,{children:Object(n.jsxs)("div",{className:"container",children:[Object(n.jsx)("h1",{children:"Vessels Page"}),Object(n.jsx)("div",{className:"row",children:Object(n.jsxs)("div",{className:"col-md-12",children:[Object(n.jsx)(u.b,{to:"/fleets",children:"Back to Fleets"})," "]})}),Object(n.jsx)("div",{className:"row",children:Object(n.jsx)("div",{className:"col-md-12",children:Object(n.jsx)("h3",{children:i.name})})}),Object(n.jsx)("div",{className:"row",children:Object(n.jsxs)("div",{className:"col-md-12",children:[Object(n.jsx)("div",{className:"top-panel d-flex",children:Object(n.jsx)(O,{onSearchChangeName:this.onSearchChangeName,onSearchChangeMMSI:this.onSearchChangeMMSI,onSearchChangeFlag:this.onSearchChangeFlag})}),Object(n.jsxs)(f.a,{style:{height:"250px"},data:Object(m.c)(j,this.state.sort),sortable:!0,sort:this.state.sort,onSortChange:function(t){e.setState({sort:t.sort})},children:[Object(n.jsx)(f.b,{field:"id",title:"Id",width:"250px"}),Object(n.jsx)(f.b,{field:"name",title:"Name",width:"200px"}),Object(n.jsx)(f.b,{field:"mmsi",title:"MMSI",width:"200px"}),Object(n.jsx)(f.b,{field:"flag",title:"Flag",width:"200px"})]})]})}),Object(n.jsx)("div",{className:"row",children:Object(n.jsx)("div",{className:"col-md-12",children:Object(n.jsxs)(x.c,Object(v.a)(Object(v.a)({},this.state.viewport),{},{width:"100vw",height:"100vh",mapStyle:"mapbox://styles/mapbox/dark-v9",onViewportChange:function(t){return e.setState({viewport:t})},mapboxApiAccessToken:"pk.eyJ1IjoiZmxlaWRtb3MiLCJhIjoiY2tobnJpemQxMDRrczMxcGU3ejZyMHB5aCJ9.Q3Tt5vnPUBzwOmoT2wpyJA",children:[Object(n.jsx)(S,{data:d,onClick:this._onClickMarker}),this._renderPopup()]}))})})]})})}}]),a}(s.Component);o.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(u.a,{children:Object(n.jsxs)(g.c,{children:[Object(n.jsx)(g.a,{exact:!0,path:"/",component:b}),Object(n.jsx)(g.a,{path:"/fleets",component:p}),Object(n.jsx)(g.a,{path:"/vessels/:id",component:N})]})})}),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.55adea8a.chunk.js.map